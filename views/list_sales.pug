doctype html
html(lang='en')
  head
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    title= title
    link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css')
    link(rel='stylesheet', href='/css/mdd.css')
    link(href='https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap', rel='stylesheet')
    script(src='https://unpkg.com/lucide@latest')

  body
    header.header
      .header-container
        .branding
          .logo
            span.icon(data-lucide='warehouse' style='width: 24px; height: 24px')
          h1 KGL Manager Dashboard
        .header-controls
          .branch-selector
            span.icon(data-lucide='map-pin' style='width: 18px; height: 18px')
            span#branchName Main Branch
          a.logout-btn(href="/logout")
            span.icon(data-lucide='log-out' style='width: 18px; height: 18px')
            | Sign Out

    nav.sidebar
      .nav-menu
        a.nav-item(href='/procurement')
          span.icon(data-lucide='package' style='width: 20px; height: 20px')
          span.nav-label Procurement
        a.nav-item(href='/sales' class='active')
          span.icon(data-lucide='dollar-sign' style='width: 20px; height: 20px')
          span.nav-label Record Sale
        a.nav-item(href='/ProducesList')
          span.icon(data-lucide='boxes' style='width: 20px; height: 20px')
          span.nav-label Inventory
        a.nav-item(href='/credit-sales')
          span.icon(data-lucide='file-text' style='width: 20px; height: 20px')
          span.nav-label Credit Sales
        a.nav-item(href='/add-user')
          span.icon(data-lucide='user-plus' style='width: 20px; height: 20px')
          span.nav-label Add User

    main.main-content.p-4
      h2.text-primary.mb-4
        span.icon(data-lucide='clipboard-list')
        | #{title}

      .table-responsive
        table.table.table-striped.table-hover
          thead
            tr
              th Product
              th Tonnage (kg)
              th Price/Unit (UGX)
              th Buyer
              th Contact
              th Branch
              th Agent
              th Sale Date
              th Actions
          tbody
            if sales && sales.length
              each sale in sales
                tr
                  td
                    if sale.productname
                      | #{sale.productname.productname || 'Unnamed'}
                    else
                      | N/A
                  td= sale.saletonnage
                  td= sale.sellingPrice.toLocaleString()
                  td= sale.buyerName
                  td= sale.buyerContact
                  td= sale.branch
                  td= sale.agentName
                  td= new Date(sale.saleDate).toLocaleDateString()
                  td.d-flex.justify-content-start.gap-2
                    button.btn.btn-sm.btn-outline-primary(onclick=`updateSale('${sale._id}')`)
                      span.icon(data-lucide='edit')
                      | Update
                    button.btn.btn-sm.btn-outline-danger(onclick=`deleteSale('${sale._id}')`)
                      span.icon(data-lucide='trash-2')
                      | Delete
            else
              tr
                td(colspan='9').text-center.py-4
                  span.icon(data-lucide='file-search' style='width: 40px; height: 40px')
                  h5.mt-3 No sales records available.
                  p.text-muted Add your first sale to get started.

    script.
      lucide.createIcons();

      function updateSale(saleId) {
        console.log('Updating sale:', saleId);
        // Add update logic here
      }

      function deleteSale(saleId) {
        if(confirm('Are you sure you want to delete this sale?')) {
          console.log('Deleting sale:', saleId);
          // Add delete logic here
        }
      }

    script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js')
